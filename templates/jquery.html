 <script type="text/javascript">
    function clear_year_options() {
        $('#years').html('');
        $('#years').append('<option value="">-</option>');
    }

    function clear_month_options() {
        $('#months').html('');
        $('#months').append('<option value="">-</option>');
    }

    function update_date_options(data) {
        if (data.measures[0].year) {
            clear_year_options();
            clear_month_options();
            data.measures.forEach(function(measure) {
                $('#years').append('<option value="' + measure.year +'">' + measure.year+ '</option>');
            });
        }  else if (data.measures[0].month) {
            clear_month_options();
            data.measures.forEach(function(measure) {
                $('#months').append('<option value="' + measure.month +'">' + measure.month_name + '</option>');
            });
        }
    }

    $(document).ready(function() {
        $('#measure_date').datepicker({dateFormat: 'yy-mm-dd'});
        
        var endpoint = '/api/measures'; 

        get_data(endpoint).done(data => {
            update_date_options(data);
            setAnnualMeasuresChart(data);
        });
    });

    $('#years').change(function() {
        year = $('#years').val();
        
        if (year) {
           year = '/' + year;
        } 

        var endpoint = '/api/measures' + year;
        
        get_data(endpoint).done(data => {
            update_date_options(data);
            setMonthlyMeasuresChart(data);
        });
    });   

    $('#months').change(function() {
        year = $('#years').val();
        month = $('#months').val();

        if (year) {
           year = '/' + year;
        } 
        if (month) {
           month = '/' +  month;
        }

        var endpoint = '/api/measures' + year + month ;

        get_data(endpoint).done(data => {
            update_date_options(data);
            setDailyMeasuresChart(data);
        });
    });
</script>